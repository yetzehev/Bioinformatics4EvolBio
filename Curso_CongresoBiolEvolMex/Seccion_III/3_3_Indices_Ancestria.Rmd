---
title: "3_3_Indices_Ancestria"
author: "Idalia Rojas"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Requerimentos

-   tess3
-   tydiverse
-   devtools
-   maps
-   LEA

```{r installation}
# install.packages("devtools")
#devtools::install_github("bcm-uga/TESS3_encho_sen")
#install.packages("maps")
#if (!require("BiocManager", quietly = TRUE))
  
#    install.packages("BiocManager")

#BiocManager::install("LEA")
```

Call libraries

```{r libraries}
library(maps)
library(tess3r)
library(LEA)
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))

```

## Indices de ancestria

Los índices de ancestría son un análisis de agrupamiento no supervisado que emplea el método de K-medias para agrupar genotipos en diferentes grupos. En este tutorial utilizaremos el paquete de R `Tess3`: <https://bcm-uga.github.io/TESS3_encho_sen/articles/main-vignette.html>

Transformar nuestro archivo en el archivo de genotipos que emplea tss3.

1.  Convertir de vcf a ped, para ello emplearemos vcftools:

```{r vcf2ped}
system("vcftools --vcf ./subset/maices_subset50.recode.vcf --plink --out ./subset/maices_subset50")
```

2.  Se recomienda partir del formato ped a lfmm

```{r formato}
input.file = "./subset/maices_subset50.ped"
output.file ="./subset/maices_subset50.geno"
maices.geno <- ped2geno(input.file, output.file, force = TRUE)
head(maices.geno)
```

## Calcular ancestria 
La ejecución de la función principal tess3 requiere dos archivos: 1) un archivo que codifique genotipos individuales, y 2) un archivo con coordenadas geográficas individuales. 

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
