# Adegenet

Instalación de `adegenet`:
```R
install.packages("adegenet")
```

```
library(adegenet)
library(ggplot2)
```

Vamos a seleccionar el folder donde tenemos guardados nuestros archivos
> Si trabajamos con distintos sets de datos de distintos proyectos, podemos crear un proyecto específico. Esto nos permitirá guardar nuestros avances, tener las librerías y carpetas cargadas sin necesidad de estar buscando cada archivo de R a la vez.

```
setwd("analysis_R/curso_rembe")
```
Se recomienda evitar los espacios en los nombres de carpetas para evitar errores de carga.

```
martillo_zyg.ind <- read.genepop ("SZ56_final.gen", ncode=3L)
```


```
sin_outs.light <- gi2gl(sin_outs.ind, parallel = FALSE, verbose = NULL)
```

```
# ----- Eigenvalues: cuál es el porcentaje de varianza explicada por los datos
sin_out.pca <- glPca(sin_outs.light, nf = 3)
barplot(100*sin_out.pca$eig/sum(sin_out.pca$eig),
        col = heat.colors(50), main="PCA Eigenvalues")
title(ylab="Percent of variance\nexplained", line = 2)
title(xlab="Eigenvalues", line = 1)

sin_out.pca
# === PCA of genlight object ===
#   Class: list of type glPca
# Call ($call):glPca(x = sin_outs.light, nf = 3)
# 
# Eigenvalues ($eig):
#   1.661 1.603 1.537 1.475 1.422 1.392 ...
# 
# Principal components ($scores):
#   matrix with 92 rows (individuals) and 3 columns (axes) 
# 
# Principal axes ($loadings):
#   matrix with 1450 rows (SNPs) and 3 columns (axes) 
```

```
#---------------- PCA

sin_out.pca.scores <- as.data.frame(sin_out.pca$scores)
sin_out.pca.scores$pop <- pop(sin_outs.light)

library(ggplot2)
set.seed(9)
pn <- ggplot(sin_out.pca.scores, aes(x=PC1, y=PC2, colour=pop)) +
  geom_point(size=2) +
  stat_ellipse(level = 0.95, size = 1) +
  scale_color_manual(values = cols) +
  geom_hline(yintercept = 0) +
  geom_vline(xintercept = 0) +
  theme_bw()

pn

```
![image](https://user-images.githubusercontent.com/45276981/158803117-2dd6fab8-96fb-42ef-a819-37284edc2788.png)
